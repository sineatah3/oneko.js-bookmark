javascript:(function(){if(window.__onekoActive){window.__onekoActive=false;cancelAnimationFrame(window.__onekoFrameId);try{window.__onekoEl.remove()}catch(e){}try{window.__onekoMenu.remove()}catch(e){}(window.__onekoBorders||[]).forEach(b=>{try{b.remove()}catch(e){}});window.__onekoHandlers&&window.__onekoHandlers.forEach(h=>window.removeEventListener(h.ev,h.fn));window.__onekoEl=null;window.__onekoMenu=null;window.__onekoHandlers=null;window.__onekoBorders=null;return}window.__onekoActive=true;const F=32,R=48,SCALE=R/F,BASE='https://raw.githubusercontent.com/sineatah3/oneko.js-bookmarkletnew/main/assets/oneko/oneko-',VARIANTS=['classic','vaporwave','maia'],MODES=['follow','drift','orbit','physics','dvd'];const FOLLOW_RADIUS=48,LERP=0.14,RADIUS_ORBIT=100,GRAVITY=0.6,FLOOR_BOUNCE=-0.45,WALL_BOUNCE=-0.6,TOP_BOUNCE=-0.6;const spriteSets={idle:[[-3,-3]],alert:[[-7,-3]],N:[[-1,-2],[-1,-3]],NE:[[0,-2],[0,-3]],E:[[-3,0],[-3,-1]],SE:[[ -5,-1],[-5,-2]],S:[[-6,-3],[-7,-2]],SW:[[-5,-3],[-6,-1]],W:[[-4,-2],[-4,-3]],NW:[[-1,0],[-1,-1]]};let cx=innerWidth/2,cy=innerHeight/2,mx=cx,my=cy,vx=0,vy=0,drag=false,dragInfo={},lastMove=Date.now(),animKey='idle',animI=0,animTimer=0,mode='follow',variant='classic',physicsSticky=false;const handlers=[];window.__onekoHandlers=handlers;const borders=[];function makeBorder(t,l,w,h,bg){const d=document.createElement('div');d.style.position='fixed';d.style.top=t;d.style.left=l;d.style.width=w;d.style.height=h;d.style.background=bg;d.style.zIndex=2147483646;document.body.appendChild(d);borders.push(d);return d}makeBorder('0','0','100%','16px','rgba(255,0,0,0.08)');makeBorder('0','0','16px','100%','rgba(0,255,0,0.04)');const rb=makeBorder('0','', '16px','100%','rgba(0,0,255,0.04)');rb.style.right='0';window.__onekoBorders=borders;const one=document.createElement('div');one.id='__oneko_el';one.style.position='fixed';one.style.width=F+'px';one.style.height=F+'px';one.style.left=cx-F/2+'px';one.style.top=cy-F/2+'px';one.style.zIndex=2147483647;one.style.imageRendering='pixelated';one.style.pointerEvents='auto';one.style.cursor='grab';one.style.transform='scale('+SCALE+')';one.style.transformOrigin='center';one.style.backgroundImage=`url(${BASE+variant}.gif)`;one.style.backgroundRepeat='no-repeat';document.body.appendChild(one);window.__onekoEl=one;const menu=document.createElement('div');menu.id='__oneko_menu';menu.style.position='fixed';menu.style.top='8px';menu.style.right='8px';menu.style.background='rgba(18,18,18,0.96)';menu.style.color='#fff';menu.style.padding='8px';menu.style.borderRadius='8px';menu.style.fontFamily='sans-serif';menu.style.zIndex=2147483647;menu.style.display='flex';menu.style.flexDirection='column';menu.style.gap='6px';menu.style.minWidth='170px';document.body.appendChild(menu);window.__onekoMenu=menu;function mkBtn(txt,cb){const b=document.createElement('button');b.textContent=txt;b.style.padding='4px 6px';b.style.cursor='pointer';b.style.border='none';b.style.borderRadius='4px';b.style.background='#333';b.style.color='#fff';b.onclick=cb;return b}const modeRow=document.createElement('div');modeRow.style.display='flex';modeRow.style.flexWrap='wrap';modeRow.style.gap='6px';MODES.forEach(m=>{const b=mkBtn(m,()=>{mode=m;vx=vy=0;dvdScale=1;dvdDirX=1;dvdDirY=1;Array.from(modeRow.children).forEach(x=>x.style.background='#333');b.style.background='#444'});if(m===mode) b.style.background='#444';modeRow.appendChild(b)});menu.appendChild(modeRow);const varRow=document.createElement('div');varRow.style.display='flex';varRow.style.gap='6px';VARIANTS.forEach(v=>{const dv=document.createElement('div');dv.title=v;dv.style.width='40px';dv.style.height='40px';dv.style.borderRadius='6px';dv.style.cursor='pointer';dv.style.backgroundImage=`url(${BASE+v}.gif)`;dv.style.backgroundSize='cover';dv.style.border='2px solid transparent';dv.onclick=()=>{variant=v;one.style.backgroundImage=`url(${BASE+variant}.gif)`;Array.from(varRow.children).forEach(x=>x.style.border='2px solid transparent');dv.style.border='2px solid #888'};varRow.appendChild(dv)});menu.appendChild(varRow);const physBtn=mkBtn('Physics: bouncy',()=>{physicsSticky=!physicsSticky;physBtn.textContent='Physics: '+(physicsSticky?'sticky':'bouncy')});physBtn.style.marginTop='6px';menu.appendChild(physBtn);function on(ev,fn,el=document){el.addEventListener(ev,fn);handlers.push({ev,fn,el});}function setSprite(key,i){const arr=spriteSets[key]||spriteSets.idle;const s=arr[i%arr.length];one.style.backgroundPosition=(s[0]*F)+'px '+(s[1]*F)+'px'}function getDir(dx,dy){const a=Math.atan2(dy,dx)*180/Math.PI;if(a>=-22.5&&a<22.5)return 'E';if(a>=22.5&&a<67.5)return 'SE';if(a>=67.5&&a<112.5)return 'S';if(a>=112.5&&a<157.5)return 'SW';if(a>=157.5||a<-157.5)return 'W';if(a>=-157.5&&a<-112.5)return 'NW';if(a>=-112.5&&a<-67.5)return 'N';return 'NE'}let dvdScale=1,dvdDirX=1,dvdDirY=1,dvdVX=3,dvdVY=2,last=performance.now();function confetti(){for(let i=0;i<22;i++){const c=document.createElement('div');c.style.width='7px';c.style.height='7px';c.style.background=['#f44336','#ffeb3b','#2196f3','#4caf50','#9c27b0'][Math.floor(Math.random()*5)];c.style.position='fixed';c.style.left=(Math.random()*innerWidth)+'px';c.style.top='0px';c.style.zIndex=2147483646;document.body.appendChild(c);let y=0;const fall=()=>{y+=3+Math.random()*3;c.style.top=y+'px';if(y>innerHeight){try{c.remove()}catch(e){}}else requestAnimationFrame(fall)};fall()}}function loop(now){const dt=Math.min(40,now-last);last=now;const px=cx,py=cy;if(!drag){if(mode==='follow'){const dx=mx-cx,dy=my-cy,dist=Math.hypot(dx,dy);if(dist>FOLLOW_RADIUS){const tx=mx-(dx/dist)*FOLLOW_RADIUS,ty=my-(dy/dist)*FOLLOW_RADIUS;cx+=(tx-cx)*LERP;cy+=(ty-cy)*LERP}}else if(mode==='drift'){vx+=(mx-cx)*0.001*(dt);vy+=(my-cy)*0.001*(dt);vx*=0.92;vy*=0.92;cx+=vx*(dt/16);cy+=vy*(dt/16)}else if(mode==='orbit'){const t=now/1000;const tx=mx+Math.cos(t*1.4)*RADIUS_ORBIT,ty=my+Math.sin(t*1.4)*RADIUS_ORBIT;cx+=(tx-cx)*0.28;cy+=(ty-cy)*0.28}else if(mode==='physics'){vy+=GRAVITY*(dt/16);cx+=vx*(dt/16);cy+=vy*(dt/16);if(cy>innerHeight-F/2){cy=innerHeight-F/2;vy*=physicsSticky?0:FLOOR_BOUNCE}}else if(mode==='dvd'){dvdScale+=0.012*dvdDirX;dvdScale=Math.min(Math.max(1,dvdScale),1.9);cx+=dvdVX*(dt/16);cy+=dvdVY*(dt/16);let corner=false;if(cx<F/2||cx>innerWidth-F/2){dvdVX*=-1;dvdDirX*=-1;corner=true}if(cy<F/2||cy>innerHeight-F/2){dvdVY*=-1;dvdDirY*=-1;corner=true}if(corner){confetti()}}}if(cx<F/2){cx=F/2;vx*=WALL_BOUNCE}if(cx>innerWidth-F/2){cx=innerWidth-F/2;vx*=WALL_BOUNCE}if(cy<F/2){cy=F/2;vy*=TOP_BOUNCE}if(cy>innerHeight-F/2){cy=innerHeight-F/2;vy*=FLOOR_BOUNCE}const mvx=cx-px,mvy=cy-py;const speed=Math.hypot(mvx,mvy);let key='idle';if(drag)key='alert';else if(mode==='physics'&&Math.abs(vy)>1)key='tired';else if(speed>0.6)key=getDir(mvx,mvy);else key='idle';animTimer+=dt;let interval=speed>2?50:speed>1?90:180;if(mode==='physics')interval*=1.6;if(animTimer>interval){animTimer=0;animI=(animI+1)%((spriteSets[key]||spriteSets.idle).length)}setSprite(key,animI);one.style.left=(cx-F/2)+'px';one.style.top=(cy-F/2)+'px';one.style.transform='scale('+(SCALE*(mode==='dvd'?dvdScale:1))+')';window.__onekoFrameId=requestAnimationFrame(loop)}on('mousemove',e=>{mx=e.clientX;my=e.clientY;lastMove=Date.now();if(drag){const now=performance.now();const dx=e.clientX-dragInfo.lastX,dy=e.clientY-dragInfo.lastY,dt=now-dragInfo.lastT||16;vx=(dx)/(dt/16);vy=(dy)/(dt/16);dragInfo.lastX=e.clientX;dragInfo.lastY=e.clientY;dragInfo.lastT=now;cx=dragInfo.startCX+(e.clientX-dragInfo.startClientX);cy=dragInfo.startCY+(e.clientY-dragInfo.startClientY)}});on('mousedown',e=>{if(e.target!==one||e.button!==0)return;drag=true;one.style.cursor='grabbing';dragInfo.startClientX=e.clientX;dragInfo.startClientY=e.clientY;dragInfo.startCX=cx;dragInfo.startCY=cy;dragInfo.lastX=e.clientX;dragInfo.lastY=e.clientY;dragInfo.lastT=performance.now()},one);on('mouseup',()=>{if(drag){drag=false;one.style.cursor='grab'}});on('keydown',e=>{if(e.key==='Escape'){cancelAnimationFrame(window.__onekoFrameId);try{one.remove()}catch(e){}try{menu.remove()}catch(e){}(window.__onekoBorders||[]).forEach(b=>{try{b.remove()}catch(e){}});window.__onekoHandlers&&window.__onekoHandlers.forEach(h=>window.removeEventListener(h.ev,h.fn));window.__onekoEl=null;window.__onekoMenu=null;window.__onekoHandlers=null;window.__onekoBorders=null;window.__onekoActive=false}});window.__onekoHandlers=handlers;window.__onekoMenu=menu;window.__onekoEl=one;window.__onekoBorders=borders;last=performance.now();window.__onekoFrameId=requestAnimationFrame(loop);})();
